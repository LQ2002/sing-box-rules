{
    "log": {
        "level": "error",
        "output": "/etc/sing-box/box.log",
        "timestamp": true
    },
    "dns": {
        "servers": [
            {
                "address": "https://dns.google/dns-query",
                "address_resolver": "local",
                "address_strategy": "ipv4_only",
                "detour": "代理",
                "strategy": "ipv4_only",
                "tag": "google"
            },
            {
                "tag": "dns_fakeip",
                "address": "fakeip"
            },
            {
                "tag": "local",
                "address": "udp://192.168.5.1",
                "detour": "direct"
            },
            {
                "tag": "dns_success",
                "address": "rcode://success"
            },
            {
                "address": "rcode://refused",
                "tag": "dns_refused"
            }
        ],
        "rules": [
            {
                "outbound": "any",
                "server": "local",
                "disable_cache": true
            },
            {
                "disable_cache": true,
                "invert": true,
                "query_type": [
                    "A",
                    "CNAME"
                ],
                "server": "dns_refused"
            },
            {
                "disable_cache": true,
                "rule_set": [
                    "apple-update",
                    "qiufen"
                ],
                "server": "dns_success"
            },
            {
                "disable_cache": true,
                "domain_suffix": [
                    "appcenter.ms",
                    "app-measurement.com",
                    "firebase.io",
                    "crashlytics.com",
                    "google-analytics.com"
                ],
                "server": "dns_success"
            },
            {
                "clash_mode": "Global",
                "server": "google"
            },
            {
                "clash_mode": "Direct",
                "server": "local"
            },
            {
                "rule_set": [
                    "geosite-!cn"
                ],
                "server": "dns_fakeip"
            },
            {
                "rule_set": [
                    "geosite-cn",
                    "geosite-tld-cn"
                ],
                "server": "local"
            },
            {
                "type": "logical",
                "mode": "and",
                "rules": [
                    {
                        "rule_set": "geosite-!cn",
                        "invert": true
                    },
                    {
                        "rule_set": [
                            "geoip-cn",
                            "DustinWin-ipcn"
                        ]
                    }
                ],
                "server": "google",
                "client_subnet": "223.5.5.5/24"
            },
            {
                "query_type": [
                    "A",
                    "CNAME"
                ],
                "server": "google",
                "client_subnet": "223.6.6.6/24"
            }
        ],
        "fakeip": {
            "enabled": true,
            "inet4_range": "198.18.0.0/16"
        },
        "final": "google",
        "independent_cache": true
    },
    "experimental": {
        "cache_file": {
            "enabled": true,
            "store_fakeip": true
        },
        "clash_api": {
            "default_mode": "rule",
            "external_controller": "0.0.0.0:9090",
            "external_ui": "ui",
            "external_ui_download_detour": "代理",
            "external_ui_download_url": "https://github.com/MetaCubeX/Yacd-meta/archive/gh-pages.zip"
        }
    },
    "inbounds": [
        {
            "listen": "::",
            "listen_port": 8888,
            "sniff": true,
            "tag": "mixed-in",
            "type": "mixed"
        },
        {
            "listen": "::",
            "listen_port": 9887,
            "sniff": true,
            "sniff_override_destination": false,
            "tag": "redirect-in",
            "type": "redirect"
        },
        {
            "listen": "::",
            "listen_port": 9888,
            "sniff": true,
            "sniff_override_destination": false,
            "tag": "tproxy-in",
            "tcp_fast_open": true,
            "tcp_multi_path": true,
            "type": "tproxy",
            "udp_fragment": true,
            "udp_timeout": "5m"
        },
        {
            "listen": "::",
            "listen_port": 5353,
            "sniff": true,
            "tag": "dns-in",
            "type": "direct"
        }
    ],
    "outbound_providers": [
        {
            "tag": "clash-http",
            "type": "http",
            "download_url": "clash 订阅链接",
            "download_interval": "24h",
            "path": "clash.yaml",
            "healthcheck_interval": "1h",
            "download_ua": "Clash.Meta",
            "download_detour": "Proxy"
        }
    ],
    "outbounds": [
        {
            "flow": "xtls-rprx-vision",
            "packet_encoding": "xudp",
            "server": "38.47.109.184",
            "server_port": 4433,
            "tag": "VEISS-reality",
            "tls": {
                "enabled": true,
                "reality": {
                    "enabled": true,
                    "public_key": "z-6h7EacJS4LngwP3u-ikq7009D3qZUk9ndGS65kOhg",
                    "short_id": "0123456789abcdef"
                },
                "server_name": "www.lovelive-anime.jp",
                "utls": {
                    "enabled": true,
                    "fingerprint": "chrome"
                }
            },
            "type": "vless",
            "uuid": "41766ff8-9eb1-4911-b385-e2dea63a5951"
        },
        {
            "down_mbps": 150,
            "obfs": {
                "password": "cry_me_a_r1ver",
                "type": "salamander"
            },
            "password": "password",
            "server": "38.47.109.184",
            "server_port": 8443,
            "tag": "VEISS-hysteria2",
            "tls": {
                "alpn": [
                    "h3"
                ],
                "ech": {
                    "config": "-----BEGIN ECH CONFIGS-----\nAFf+DQBTAAAgACAFGhp0ZGW2x182qdTrZ4RsovwUEVy5rE+ujLMJI+vANQAIAAEA\nAQABAAMAIFstLXBxLXNpZ25hdHVyZS1zY2hlbWVzLWVuYWJsZWRdAAA=\n-----END ECH CONFIGS-----\n",
                    "dynamic_record_sizing_disabled": false,
                    "enabled": true,
                    "pq_signature_schemes_enabled": true
                },
                "enabled": true,
                "server_name": "sing.leeky.life",
                "utls": {
                    "fingerprint": "chrome_pq_psk"
                }
            },
            "type": "hysteria2",
            "up_mbps": 30
        },
        {
            "type": "direct",
            "tag": "direct"
        },
        {
            "type": "block",
            "tag": "block"
        },
        {
            "type": "dns",
            "tag": "dns-out"
        },
        {
            "type": "urltest",
            "tag": "订阅",
            "providers": [
                "clash-http"
            ],
            "outbounds": []
        },
        {
            "type": "urltest",
            "tag": "HK",
            "providers": [
                "clash-http"
            ],
            "outbounds": [],
            "includes": [
                "^HK\\..+"
            ]
        },
        {
            "type": "urltest",
            "tag": "SG",
            "providers": [
                "clash-http"
            ],
            "outbounds": [],
            "includes": [
                "^SG\\..+"
            ]
        },
        {
            "interrupt_exist_connections": true,
            "outbounds": [
                "VEISS-reality",
                "VEISS-hysteria2"
            ],
            "tag": "自建",
            "type": "selector"
        },
        {
            "type": "selector",
            "tag": "手动选择",
            "providers": [
                "clash-http"
            ],
            "outbounds": []
        },
        {
            "type": "selector",
            "tag": "代理",
            "outbounds": [
                "订阅",
                "HK",
                "SG",
                "direct",
                "自建",
                "手动选择"
            ]
        },
        {
            "type": "selector",
            "tag": "Global",
            "outbounds": [
                "手动选择",
                "direct"
            ]
        }
    ],
    "route": {
        "find_process": true,
        "final": "代理",
        "auto_detect_interface": true,
        "rules": [
            {
                "ip_version": 6,
                "outbound": "Adblock"
            },
            {
                "protocol": "BitTorrent",
                "outbound": "direct"
            },
            {
                "mode": "or",
                "outbound": "dns-out",
                "rules": [
                    {
                        "protocol": "dns"
                    },
                    {
                        "port": 53
                    }
                ],
                "type": "logical"
            },
            {
                "ip_is_private": true,
                "outbound": "direct"
            },
            {
                "network": "udp",
                "outbound": "Adblock",
                "port": 443
            },
            {
                "outbound": "direct",
                "port": 22
            },
            {
                "domain_suffix": [
                    "appcenter.ms",
                    "app-measurement.com",
                    "firebase.io",
                    "crashlytics.com",
                    "google-analytics.com"
                ],
                "outbound": "Adblock"
            },
            {
                "outbound": "Adblock",
                "rule_set": [
                    "apple-update",
                    "qiufen"
                ]
            },
            {
                "outbound": "direct",
                "protocol": "stun"
            },
            {
                "mode": "or",
                "outbound": "Adblock",
                "rules": [
                    {
                        "domain_regex": "^stun\\..+"
                    },
                    {
                        "domain_keyword": [
                            "stun",
                            "httpdns"
                        ]
                    }
                ],
                "type": "logical"
            },
            {
                "clash_mode": "Direct",
                "outbound": "direct"
            },
            {
                "clash_mode": "Global",
                "outbound": "代理"
            },
            {
                "outbound": "HK",
                "rule_set": "geoip-hk"
            },
            {
                "outbound": "SG",
                "rule_set": "geoip-sg"
            },
            {
                "mode": "and",
                "outbound": "direct",
                "rules": [
                    {
                        "invert":true,
                        "rule_set":[
                            "geolocation-!cn"
                        ]
                    },
                    {
                        "rule_set": [
                            "geosite-cn",
                            "DustinWin-sitecn",
                            "geosite-tld-cn"
                        ]
                    },
                    {
                        "rule_set": [
                            "geoip-cn",
                            "DustinWin-ipcn"
                        ]
                    }
                ],
                "type": "logical"
            },
            {
                "mode": "and",
                "outbound": "direct",
                "rules": [
                    {
                        "rule_set": [
                            "geoip-cn"
                        ]
                    },
                    {
                        "rule_set": [
                            "DustinWin-ipcn"
                        ]
                    }
                ],
                "type": "logical"
            }
        ],
        "rule_set": [
            {
                "download_detour": "代理",
                "format": "source",
                "tag": "qiufen",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main/Filters/AWAvenue-Ads-Rule-Singbox.json"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geoip-cn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Yuu518/sing-box-rules/rule_set/rule_set_ip/cn.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geosite-cn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Raudeck/v2fly-domains/sing_ruleset/geosite-cn.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "apple-update",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Toperlock/sing-box-geosite/main/rule/BlockiOSUpdate.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geosite-tld-cn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-tld-cn.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geoip-hk",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Yuu518/sing-box-rules/rule_set/rule_set_ip/hk.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geoip-sg",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Yuu518/sing-box-rules/rule_set/rule_set_ip/sg.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "DustinWin-sitecn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/DustinWin/ruleset_geodata/sing-box-ruleset/cn.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "DustinWin-ipcn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/DustinWin/ruleset_geodata/sing-box-ruleset/cnip.srs"
            },
            {
                "download_detour": "代理",
                "format": "binary",
                "tag": "geosite-!cn",
                "type": "remote",
                "update_interval": "1d",
                "url": "https://raw.githubusercontent.com/Yuu518/sing-box-rules/rule_set/rule_set_site/geolocation-!cn-all.srs"
            }
        ]
    }
}